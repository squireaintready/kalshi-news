{% extends "base.html" %}
{% block title %}Dashboard - Prediction Pulse{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <h1>Your Dashboard</h1>
        <p>Welcome back, {{ current_user.email }}</p>
    </div>

    {% if not user_bets and not categories %}
    <div class="connect-banner">
        <div class="connect-banner-content">
            <h3>Start Your Watchlist</h3>
            <p>Follow categories or specific bets to get personalized articles.</p>
        </div>
        <a href="{{ url_for('watchlist') }}" class="btn btn-primary">Get Started</a>
    </div>
    {% endif %}

    {% if categories or user_bets %}
    <section class="dashboard-section">
        <div class="section-header">
            <h2>Following</h2>
            <a href="{{ url_for('watchlist') }}" class="btn btn-secondary btn-small">Manage</a>
        </div>
        <div class="watchlist-preview">
            {% for cat in categories %}
            <span class="category-tag">{{ cat }}</span>
            {% endfor %}
            {% for bet in user_bets %}
            <span class="bet-tag">{{ bet.title[:35] }}{% if bet.title|length > 35 %}...{% endif %}</span>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if my_articles %}
    <section class="dashboard-section">
        <h2>Your Articles</h2>
        <div class="articles-grid">
            {% for article in my_articles %}
            <article class="article-card">
                <div class="article-meta">
                    {% if article.article_type == 'results' %}
                    <span class="badge badge-results">RESULTS</span>
                    {% else %}
                    <span class="badge badge-analysis">ANALYSIS</span>
                    {% endif %}
                    <span class="article-date">{{ article.generated_at|format_date }}</span>
                </div>
                <h3><a href="{{ url_for('article_page', article_id=article.id) }}">{{ article.title }}</a></h3>
                <p class="article-teaser">{{ article.teaser }}</p>
                <div class="article-stats">
                    <span class="probability">{{ article.probability }}% odds</span>
                    <span class="read-time">{{ article.word_count|estimate_read_time }} min read</span>
                </div>
            </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="dashboard-section">
        <h2>Latest Articles</h2>
        <div class="articles-grid">
            {% for article in all_articles %}
            <article class="article-card article-card-small">
                <div class="article-meta">
                    <span class="article-date">{{ article.generated_at|format_date }}</span>
                </div>
                <h3><a href="{{ url_for('article_page', article_id=article.id) }}">{{ article.title }}</a></h3>
                <div class="article-stats">
                    <span class="probability">{{ article.probability }}%</span>
                </div>
            </article>
            {% endfor %}
        </div>
        <div class="view-all">
            <a href="{{ url_for('index') }}" class="btn btn-secondary">View All Articles</a>
        </div>
    </section>
</div>
{% endblock %}
